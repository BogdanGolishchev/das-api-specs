<!---
  Â© Copyright IBM Corp. 2017
  
  Licensed under the Apache License, Version 2.0 (the "License"); 
  you may not use this file except in compliance with the License. 
  You may obtain a copy of the License at:
  
  http://www.apache.org/licenses/LICENSE-2.0 
  
  Unless required by applicable law or agreed to in writing, software 
  distributed under the License is distributed on an "AS IS" BASIS, 
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or 
  implied. See the License for the specific language governing 
--->

# Node.js samples using the DAS Calendar API
Sample code showing use of Domino Access Services (DAS) with Swagger
generated client code.  You can use this code to test calendar client 
code generated by
[Swagger Codegen](https://github.com/swagger-api/swagger-codegen).

### Prerequisites
- A Domino server with the calendar API installed and enabled.
- A Node.js runtime environment.
- A Node.js package generated from **calendar.yaml**.  For example,
  you can use the [online Swagger editor](http://editor2.swagger.io)
  to import **calendar.yaml** and then generate a "Javascript" client.

# Instructions
These instructions show how to install and run [noticetest.js](noticetest.js).
To run a different calendar client sample, follow these same instructions
and substitute file names where appropriate.

First create a root folder and two sub-folders as shown below:

```
/tests
/tests/ibm_domino_calendar_api
/tests/noticetest
```

The root folder name is not important.  Choose a name other than
**/tests** if necessary.

### Unzip the generated client code
Next unzip the generated code to **/tests/ibm_domino_calendar_api**.
When you are finished, the contents of the folder should look
something like this:

```
docs
src
test
.swagger-codegen-ignore
.travis.yml
git_push.sh
mocha.opts
package.json
README.md
```

### Create your Node.js application
Now use **npm** to initialize your Node.js application. Use a Node.js 
command shell to execute the following commands:

```
cd /tests/noticetest
npm init
```

The **npm** command will prompt you for information about your
application.  Be sure to specify **noticetest.js** as the
entry point.  Otherwise, you can accept the default values
as shown below:

```
name: (noticetest)
version: (1.0.0)
description: Calendar API test
entry point: (index.js) noticetest.js
test command:
git repository:
keywords:
author:
license: (ISC)
```

Use **npm** to make your application dependent on **ibm_domino_calendar_api**
(the generated client code):

```
npm install --save ../ibm_domino_calendar_api
```

Download [noticetest.js](noticetest.js) to the **/tests/noticetest** folder.
Then open your local copy of **noticetest.js** in your favorite text editor
and customize the following values for your environment:

```javascript
// IMPORTANT: Change these values to match your test environment:
//
// - basePath is the base URL for your Domino server.
//   The calendar service MUST be installed and enabled
//   on the server.  Be sure to change the protocol to
//   http if your sever doesn't support https.
//
// - username is the name of a user who has access to your
//   Domino server
//
// - password is the user's password
//
// - folder is the mail file folder name
//
// - database is the mail file database name
//

var basePath = "https://yourserver.yourorg.com";
var username = "First Last";
var password = "password";
var folder = "mail";
var database = "database.nsf"
```

### Run your Node.js application
After saving your local changes, return to the Node.js command shell to run 
your application:

```
node noticetest.js
```

The following is some sample output from a successful run:

```
/tests/noticetest> node noticetest.js
Requesting invitations for Duke Lawson ...
Invitations API called successfully. Response follows ...

summary: Pi Day celebration
href: /mail/dlawson.nsf/api/calendar/notices/FED0A59156EF7B31852580CE00539688

summary: St. Patrick's Day
href: /mail/dlawson.nsf/api/calendar/notices/F600D2B8AC497393852580CE0053A66A
```

In other words, the **noticetest.js** application displays a list of the
unprocessed invitations for the specified user.  You can also accept the
invitations with the optional **-a** parameter.  Try the following
command only if you are sure you want to accept all invitations:

```
node noticetest.js -a
```
